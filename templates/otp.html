<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cifrario One Time Pad (OTP)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='otp_style.css') }}">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <a href="/" class="home-btn"><i class="fas fa-arrow-left"></i> Menu</a>
            <h1>Cifrario One Time Pad (XOR)</h1>
            <p>Secrecy perfetta tramite operazione XOR bit a bit.</p>
        </header>

        <!-- Perfect Secrecy Content -->
        <section class="section">
            <div class="card perfect-secrecy-card">
                <h2><i class="fas fa-crown"></i> La Segretezza Perfetta (Perfect Secrecy)</h2>
                <p>È perfetto perché possiede la <strong>Segretezza Perfetta</strong> teorizzata da Claude Shannon. È
                    matematicamente impossibile da rompere, anche con infinita potenza di calcolo.</p>

                <div class="theory-comparison">
                    <div class="theory-block conditional">
                        <h3>Sicurezza Computazionale</h3>
                        <p>Algoritmi come AES, RSA:</p>
                        <p><em>"Si può rompere, ma ci vorrebbero 1 miliardo di anni"</em>.</p>
                    </div>
                    <div class="theory-block unconditional">
                        <h3>Sicurezza Incondizionata</h3>
                        <p>OTP/Vernam:</p>
                        <p><em>"Non si può rompere, punto."</em></p>
                    </div>
                </div>

                <h3><i class="fas fa-gavel"></i> Le 3 Regole di Shannon</h3>
                <p>Per ottenere questa magia, devi rispettare 3 regole rigidissime. Se ne violi anche solo una, il
                    sistema
                    crolla.</p>
                <ul class="shannon-rules">
                    <li><strong>1. Casualità:</strong> La chiave deve essere generata in modo Veramente Casuale (non da
                        un computer, ma da processi fisici come decadimento radioattivo o lancio di dadi). Se usi un
                        computer (pseudo-random), diventa un Stream Cipher
                        violabile (come RC4).</li>
                    <li><strong>2. Lunghezza:</strong> La chiave deve essere lunga almeno quanto il messaggio. <br>
                        (Per cifrare un file da 1GB, serve una chiave da 1GB).</li>
                    <li><strong>3. Monouso (One-Time):</strong> La chiave non deve MAI essere riutilizzata. <br>
                        <small>
                            Se usi la stessa chiave \(K\) per due messaggi \(M_1\) e \(M_2\):<br>
                            1. \(C_1 = M_1 \oplus K\) <br>
                            2. \(C_2 = M_2 \oplus K\) <br>
                            3. L'attaccante fa lo XOR dei cifrati: \(C_1 \oplus C_2\) <br>
                            4. Risultato: \((M_1 \oplus K) \oplus (M_2 \oplus K) = M_1 \oplus M_2\) <br>
                            <strong>La chiave \(K\) si è cancellata!</strong> (Perché \(K \oplus K = 0\)). L'attaccante
                            ora può leggere i messaggi.
                        </small>
                    </li>
                </ul>

                <div class="alert-box warning">
                    <strong>"Se è perfetto, perché non lo usiamo sempre?"</strong><br>
                    Risposta: Per il <strong>Problema della Distribuzione delle Chiavi</strong>.<br>
                    Se devo mandare a Bob un file segreto da 1GB, devo prima incontrarlo fisicamente per dargli una
                    chiavetta USB con la chiave OTP da 1GB. Ma se posso incontrarlo fisicamente per dargli la chiave...
                    tanto vale che gli dia direttamente il file segreto!
                </div>
            </div>
        </section>

        <section class="controls">
            <div class="input-group">
                <label for="plaintext">Testo in Chiaro:</label>
                <input type="text" id="plaintext" placeholder="Inserisci il testo" value="HELLO">
            </div>

            <div class="input-group">
                <label for="key">Chiave (Lascia vuoto per generare casualmente):</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="key" placeholder="Chiave..." value="">
                    <button id="genKeyBtn" class="secondary" style="white-space: nowrap;">Genera Chiave</button>
                </div>
            </div>

            <button id="encryptBtn">Cifra con XOR</button>
            <button id="resetBtn" class="secondary">Reset</button>
        </section>

        <section id="visualization" class="hidden">
            <div id="otp-container"></div>

            <div id="output-container">
                <h3>Risultato (Messaggio):</h3>
                <div id="ciphertext-display"></div>
            </div>
        </section>

        <div style="text-align: center; margin-top: 50px; margin-bottom: 20px;">
            <a href="/" style="text-decoration: none;">
                <button
                    style="padding: 10px 20px; font-size: 1em; background: #30363d; color: #fff; border: 1px solid #8b949e; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-arrow-left"></i> Torna al Menu
                </button>
            </a>
        </div>
    </div>

    <script src="{{ url_for('static', filename='otp_script.js') }}"></script>
</body>

</html>