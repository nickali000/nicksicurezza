<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL/TLS Visualization</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='tls_style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <a href="/" class="home-btn"><i class="fas fa-arrow-left"></i> Menu</a>

    <div class="container">
        <h1>SSL / TLS</h1>
        <div class="subtitle">La Sicurezza del Web (Da Netscape alla IETF)</div>

        <!-- SECTION 1: PURPOSE (A COSA SERVE?) -->
        <h2 style="text-align:center; margin-bottom:10px;">1. A Cosa Serve? (L'Obiettivo)</h2>
        <div
            style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; border-left: 5px solid var(--accent-color); margin-bottom: 40px;">
            <p style="font-size: 1.1em; margin-bottom: 15px;">
                Senza SSL/TLS, Internet sarebbe come spedire <strong>cartoline postali</strong>: chiunque (postini,
                smistatori) può leggere cosa c'è scritto, modificarlo o fingere di essere il mittente.
            </p>
            <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; text-align: center;">
                <div style="flex: 1; min-width: 200px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                    <i class="fas fa-user-secret"
                        style="font-size: 2em; color: var(--accent-color); margin-bottom: 10px;"></i>
                    <h3 style="margin: 5px 0;">Riservatezza</h3>
                    <p style="font-size: 0.9em; color: #ccc;">Nessuno può leggere i dati (Cifratura).</p>
                </div>
                <div style="flex: 1; min-width: 200px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                    <i class="fas fa-check-circle"
                        style="font-size: 2em; color: var(--accent-color); margin-bottom: 10px;"></i>
                    <h3 style="margin: 5px 0;">Integrità</h3>
                    <p style="font-size: 0.9em; color: #ccc;">Nessuno ha modificato i dati (MAC).</p>
                </div>
                <div style="flex: 1; min-width: 200px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                    <i class="fas fa-id-badge"
                        style="font-size: 2em; color: var(--accent-color); margin-bottom: 10px;"></i>
                    <h3 style="margin: 5px 0;">Autenticazione</h3>
                    <p style="font-size: 0.9em; color: #ccc;">So davvero con chi parlo (Certificati).</p>
                </div>
            </div>
        </div>

        <!-- SECTION 2: HISTORY (LA STORIA) -->
        <h2 style="text-align:center; margin-bottom:10px;">2. Una Storia Travagliata</h2>
        <div style="position: relative; margin-bottom: 40px; padding: 20px; border-left: 2px solid #555;">

            <div style="margin-bottom: 25px;">
                <h3 style="color: #f85149; font-size: 1.4rem; margin-bottom: 10px;"><i class="fas fa-times-circle"></i>
                    Le Origini: Netscape SSL</h3>
                <p style="font-size: 1.2rem; line-height: 1.6;">
                    Negli anni '90, <strong>Netscape</strong> inventa <strong>SSL (Secure Sockets Layer)</strong> per il
                    suo browser.
                    Ma nasce male: la versione 1.0 non esce mai (troppi bug), la 2.0 viene bucata subito.
                    Si arriva a <strong>SSL 3.0</strong>, che diventa lo standard di fatto per anni.
                </p>
            </div>

            <div style="margin-bottom: 25px;">
                <h3 style="color: #db6d28; font-size: 1.4rem; margin-bottom: 10px;"><i
                        class="fas fa-exclamation-circle"></i> I Problemi di SSL</h3>
                <p style="font-size: 1.2rem; line-height: 1.6;">
                    SSL era proprietario e aveva difetti strutturali gravi (come il pessimo sistema di Padding che
                    porterà
                    all'attacco POODLE).
                    Serviva qualcosa di aperto, sicuro e standardizzato.
                </p>
            </div>

            <div>
                <h3 style="color: var(--accent-color); font-size: 1.4rem; margin-bottom: 10px;"><i
                        class="fas fa-globe"></i> La Standardizzazione: Arriva TLS
                </h3>
                <p style="font-size: 1.2rem; line-height: 1.6;">
                    La <strong>IETF</strong> (l'organizzazione che gestisce gli standard di Internet) prende in mano la
                    situazione.
                    Non potendo usare il nome "SSL" (marchio Netscape), lo rinomina <strong>TLS (Transport Layer
                        Security)</strong>.
                </p>
                <div
                    style="background: #252526; padding: 15px; border-radius: 5px; margin-top: 15px; text-align: center; font-family: monospace; font-size: 1.1rem;">
                    "TLS 1.0 è, in pratica, SSL 3.1. Stessa famiglia, nome diverso."
                </div>
            </div>
        </div>

        <!-- SECTION 3: TECHNICAL SHOWDOWN -->
        <h2 style="text-align:center; margin-bottom:10px;">3. Il Confronto Tecnico (SSL vs TLS)</h2>
        <p style="text-align:center; color:#8b949e; margin-bottom: 20px; font-size: 1.1rem;">
            Spesso usati come sinonimi, tecnicamente sono abissalmente diversi.
            <strong>SSL è rotto</strong> e insicuro per design. <strong>TLS è l'evoluzione corretta</strong>.
        </p>

        <div class="comparison-grid">
            <!-- Left: SSL (Bad) -->
            <div class="comp-column">
                <div class="comp-header header-ssl"><i class="fas fa-thumbs-down"></i> SSL (Obsoleto)</div>

                <div class="comp-card bad">
                    <span class="comp-label">Integrità (MAC)</span>
                    <div class="comp-val">MAC "Fatto in Casa"</div>
                    <div style="font-size:0.95em; margin-top:5px;">Una costruzione amatoriale e vulnerabile.</div>
                </div>

                <div class="comp-card bad">
                    <span class="comp-label">Padding (Riempimento)</span>
                    <div class="comp-val">Non Specificato</div>
                    <div style="font-size:0.95em; margin-top:5px;">Il server ignorava il contenuto del padding.
                        <br><i class="fas fa-arrow-right"></i> Ha permesso l'attacco <strong>POODLE</strong>.
                    </div>
                </div>

                <div class="comp-card bad">
                    <span class="comp-label">Algoritmi</span>
                    <div class="comp-val">RC4, DES, MD5</div>
                    <div style="font-size:0.95em; margin-top:5px;">Cifrari deboli oggi facili da decifrare.</div>
                </div>
            </div>

            <!-- Right: TLS (Good) -->
            <div class="comp-column">
                <div class="comp-header header-tls"><i class="fas fa-thumbs-up"></i> TLS (Moderno)</div>

                <div class="comp-card good">
                    <span class="comp-label">Integrità (MAC)</span>
                    <div class="comp-val">HMAC Standard</div>
                    <div style="font-size:0.95em; margin-top:5px;">Usa lo standard HMAC (Hash-based Message
                        Authentication Code).</div>
                </div>

                <div class="comp-card good">
                    <span class="comp-label">Padding (Riempimento)</span>
                    <div class="comp-val">Rigoroso</div>
                    <div style="font-size:0.95em; margin-top:5px;">Deve essere controllato byte per byte. Nessuna
                        ambiguità.</div>
                </div>

                <div class="comp-card good">
                    <span class="comp-label">Algoritmi</span>
                    <div class="comp-val">AES-GCM, ECDHE</div>
                    <div style="font-size:0.95em; margin-top:5px;">Usa Crittografia Autenticata (AEAD) e Perfect Forward
                        Secrecy.</div>
                </div>
            </div>
        </div>


        <!-- SECTION 4: THE SANDWICH -->
        <h2 style="text-align:center; margin-bottom:10px;">4. Dove si trova?</h2>
        <p style="text-align:center; color:#8b949e; margin-bottom: 20px;">Ora che sappiamo il perché, vediamo il dove.
            Si mette in mezzo tra le App e la Rete.</p>
        <div class="stack-section">
            <div class="stack-container">
                <div class="stack-block block-app">
                    7. Application (HTTP, SMTP)
                    <div class="stack-label">Dati in Chiaro</div>
                </div>
                <!-- THE CUSHION -->
                <div class="stack-block block-tls">
                    <i class="fas fa-lock"></i> SSL / TLS Protocol
                    <div class="stack-label" style="color:var(--layer-tls);">Il Cuscinetto</div>
                </div>
                <div class="stack-block block-tcp">
                    4. Transport (TCP)
                    <div class="stack-label">Trasporto</div>
                </div>
                <div class="stack-block block-ip">
                    3. Network (IP)
                    <div class="stack-label">Instradamento</div>
                </div>
            </div>
        </div>



        <!-- SECTION 5: HANDSHAKE FLOW -->
        <h2 style="text-align:center; margin-bottom:10px;">5. L'Handshake (La Negoziazione)</h2>
        <div style="text-align:center; margin-bottom:20px;">
            <button class="btn-control btn-start" onclick="nextStep()" id="btn-next">Simula Handshake <i
                    class="fas fa-arrow-right"></i></button>
            <button class="btn-control btn-reset" onclick="resetSim()"><i class="fas fa-undo"></i> Reset</button>
        </div>

        <div class="handshake-container">
            <div class="hs-step" id="step-0">
                <div class="hs-num">1</div>
                <div>
                    <strong>Hello (Client & Server)</strong><br>
                    <small>Accordo sulla versione (es. TLS 1.2) e algoritmo.</small>
                </div>
                <div class="hs-visual"><i class="fas fa-comments"></i></div>
            </div>
            <div class="hs-step" id="step-1">
                <div class="hs-num">2</div>
                <div>
                    <strong>Certificato & Auth</strong><br>
                    <small>Il server prova la sua identità.</small>
                </div>
                <div class="hs-visual"><i class="fas fa-id-card"></i></div>
            </div>
            <div class="hs-step" id="step-2">
                <div class="hs-num">3</div>
                <div>
                    <strong>Scambio Chiavi</strong><br>
                    <small>Si genera la chiave di sessione.</small>
                </div>
                <div class="hs-visual"><i class="fas fa-key"></i></div>
            </div>
            <div class="hs-step" id="step-3">
                <div class="hs-num">4</div>
                <div>
                    <strong>Finished!</strong><br>
                    <small>Canale cifrato attivo.</small>
                </div>
                <div class="hs-visual"><i class="fas fa-lock"></i></div>
            </div>
        </div>




        <!-- SECTION 6: POODLE ATTACK -->
        <h2 style="text-align:center; margin-top:50px; margin-bottom:10px;">6. Perché SSL 3.0 è morto? (POODLE)</h2>
        <div class="subtitle" style="margin-bottom:10px; color: #ed8936;">L'attacco che morde l'imbottitura</div>

        <div class="poodle-section">
            <p style="text-align: center; margin-bottom: 20px;">
                POODLE (Padding Oracle On Downgraded Legacy Encryption) è l'esempio perfetto di perché la
                <strong>retro-compatibilità</strong> può essere fatale.
            </p>

            <div style="display:flex; justify-content:center; gap:20px; flex-wrap:wrap;">
                <div style="flex:1; min-width:300px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                    <h3 style="color: #ed8936;">Atto 1: Downgrade Dance</h3>
                    <p>L'attaccante disturba la connessione finché Browser e Server non dicono: <em>"Ok, TLS non va,
                            proviamo col vecchio SSL 3.0!"</em>. Appena scendono nel passato, sono vulnerabili.</p>
                    <div class="staircase" style="margin-top: 15px;">
                        <div class="step-card secure" style="width: auto;">TLS 1.2 <i class="fas fa-check"></i></div>
                        <div style="color:red; font-size: 1.5rem;">⬇️ Costretto a scendere</div>
                        <div class="step-card insecure" style="width: auto;">SSL 3.0 <i class="fas fa-skull"></i></div>
                    </div>
                </div>

                <div style="flex:1; min-width:300px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                    <h3 style="color: #ed8936;">Atto 2: Padding Oracle</h3>
                    <p>SSL 3.0 gestiva male il Padding (riempimento) dei blocchi. L'attaccante può indovinare i byte del
                        <strong>cookie di sessione</strong> osservando semplicemente se il server accetta o rifiuta
                        pacchetti modificati.
                    </p>
                    <div style="text-align: center; margin-top: 20px; font-size: 3rem; color: #ed8936;"><i
                            class="fas fa-dog"></i></div>
                </div>
            </div>
        </div>

        <!-- SECTION 7: MODERN TLS (1.3 + PFS) -->
        <h2 style="text-align:center; margin-top:50px; margin-bottom:10px;">7. Il Futuro: TLS 1.3 e Forward Secrecy</h2>

        <!-- TLS 1.3 TRASH CAN -->
        <div class="subtitle">Pulizie di Primavera (TLS 1.3)</div>
        <p style="text-align: center;">TLS 1.3 (l'attuale standard) è sicuro perché ha <strong>rimosso</strong> tutto
            ciò che era vecchio.</p>
        <div class="trash-container">
            <div class="trash-bin"><i class="fas fa-trash-alt"></i></div>
            <div>
                <span class="trash-item">SSL & TLS 1.0</span>
                <span class="trash-item">RC4 & DES</span>
                <span class="trash-item">MD5</span>
                <span class="trash-item">RSA Key Exchange</span>
            </div>
            <div style="margin-top: 5px; color: #aaa; font-size: 0.9em;">(Cestino della Storia)</div>
        </div>

        <!-- PFS vs RSA -->
        <div class="subtitle" style="margin-top: 30px;">Perfect Forward Secrecy (PFS)</div>
        <p style="text-align: center;">La differenza fondamentale tra il vecchio RSA e il moderno ECDHE.</p>

        <div class="pfs-container">
            <div class="pfs-box rsa">
                <div class="pfs-icon" style="color:#cbd5e0;"><i class="fas fa-archive"></i></div>
                <div class="pfs-title">RSA Key Exchange (Vecchio)</div>
                <div class="pfs-desc">
                    <p>Come un <strong>Archivio</strong>.</p>
                    <p>Se rubano la chiave tra 10 anni, possono aprire l'archivio e decifrare le conversazioni di oggi.
                    </p>
                </div>
            </div>

            <div class="pfs-box ecdhe">
                <div class="pfs-icon" style="color:#48bb78;"><i class="fas fa-file-shredder"></i></div>
                <div class="pfs-title">ECDHE (Nuovo)</div>
                <div class="pfs-desc">
                    <p>Come un <strong>Distruggidocumenti</strong>.</p>
                    <p>Le chiavi sono effimere. Se rubano la chiave maestra domani, il passato resta illeggibile.</p>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 50px; margin-bottom: 20px;">
            <a href="/" style="text-decoration: none;">
                <button
                    style="padding: 10px 20px; font-size: 1em; background: #30363d; color: #fff; border: 1px solid #8b949e; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-arrow-left"></i> Torna al Menu
                </button>
            </a>
        </div>

    </div>

    <script>
        let currentStep = -1;
        const totalSteps = 4;

        function nextStep() {
            if (currentStep < totalSteps - 1) {
                currentStep++;
                updateUI();
            }
        }

        function resetSim() {
            currentStep = -1;
            document.querySelectorAll('.hs-step').forEach(el => el.classList.remove('active'));
            document.getElementById('btn-next').innerHTML = 'Simula Handshake <i class="fas fa-arrow-right"></i>';
        }

        function updateUI() {
            document.querySelectorAll('.hs-step').forEach((el, idx) => {
                if (idx === currentStep) {
                    el.classList.add('active');
                } else {
                    el.classList.remove('active');
                }
            });

            if (currentStep === totalSteps - 1) {
                document.getElementById('btn-next').innerText = "Connessione Sicura!";
            }
        }
    </script>
</body>

</html>